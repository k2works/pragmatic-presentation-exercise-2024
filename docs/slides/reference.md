# 戦略的設計の３つの基本原則（コンテキスト、蒸留、大規模な構造）

## コンテキスト

> コンテキストはこれらの原則の中で最もわかりにくいものだが、実は最も根本的なものである。
>
> エリック・エバンスのドメイン駆動設計

> 理想的な世界なら、エンタープライズの全ドメインに広がる１つだけのモデルが手に入るかもしない。このモデルは統一されていて、用語の定期に矛盾も重複もなく、ドメインに関するあらゆる論理的な声明が一貫していることだろう。
> しかし、巨大なシステム開発の世界は理想と違う。エンタープライズシステム全体で、そのレベルの統一を維持するには苦労が多いが、その割に得られるものはすくない。
>
> エリック・エバンスのドメイン駆動設計

> 巨大なシステム向けのドメインモデルを完全に統一することは、現実的ではないし、コストにも見合わない。
>
> エリック・エバンスのドメイン駆動設計

> エンタープライズ全体のための統一モデルを維持するのが現実的ではないとしても、我々にできることがないわけではない。何を統一すべきかについての前向きな意思決定と、何を統一しないでおくかについての現実に即した認識を組み合わせることで、置かれている状況に関する明確な全体像を共有できる。この全体像があれば、確実に統一したい部分を統一する方向に向けつつ、統一しない部分のせいで混乱や破損が生じないようにすることに着手できる。
> さまざまなモデル間の境界と関係性をはっきりさせる方法が必要である。戦略を意識的に選択し、その後は、一貫してその戦略に従わなければならない。
>
> エリック・エバンスのドメイン駆動設計

> すべてはプロジェクトの現在の領域をマッピングするところから始まる。境界づけられたコンテキストによって、各モデルを適用できる範囲が定義され、コンテキストマップによって、プロジェクトのコンテキストと、それらコンテキスト間の関係性を全体的に概観できるようになる。
>
> エリック・エバンスのドメイン駆動設計

### 境界づけられたコンテキスト(Bounded Context)

> 複数のモデルはどんな巨大なプロジェクトにも存在する。だが、別々のモデルに基づくコードが組み合わされると、ソフトウエアは、バグの温床となり、信頼できなくなり、理解しにくくなる。チームメンバ間のコミュニケーションは混乱を始める。あるモデルをどのコンテキストで適用すべきでないかについては、ほとんどの場合不明瞭である。
>
> エリック・エバンスのドメイン駆動設計

> モデルが適用されるコンテキストを明示的に定義すること。明示的な境界は、チーム編成、そのアプリケーションに特有の部分が持つ用途、コードベースやデータベーススキーマなどの物理的な表現などの観点から設定すること。ただし、境界の外部の問題によって注意を逸らされたり、混乱させられたりするのを避けるｋと。
>
> エリック・エバンスのドメイン駆動設計

> 別々のモデルの要素が組合わせると、２種類の問題が生じる。それが、重複した概念と偽同族語(false cognate)だ。
>
> エリック・エバンスのドメイン駆動設計

### 継続的な統合(Continuous Integration)

> 多くの人々が同一の境界づけられたコンテキストで作業していると、モデルが分裂する傾向は強くなる。チームが大きければ大きいほど、問題も大きくなるが、３，４人ほどの少人数でも深刻な問題に直面することがある。しかし、システムをさらに小さいコンテキストに分割してしまうと、結局は有益なレベルで統合し、一貫させることができなくなる。
>
> エリック・エバンスのドメイン駆動設計

> 最も純粋なかたちのXPは、単一の境界づけられたコンテキスト内でモデルの整合性を維持するのに適している。
>
> エリック・エバンスのドメイン駆動設計

> すべてのコードと他の実装成果物を頻繁にマージさせるプロセスを策定すること。その際、分裂に対して素早く警告する自動化されたテストも一緒に用いること。ユビキタス言語の執拗な鍛錬を絶え間なく行い、モデルに対する共有された見方を練り上げること。概念は、別々の人の頭の中で進化して行くからだ。
>
> エリック・エバンスのドメイン駆動設計

### コンテキストマップ(Context Map)

> 境界づけられたコンテキスト間でもコードの再利用は、危険なので避けるべきである。
>
> エリック・エバンスのドメイン駆動設計

> プロジェクトで機能しているモデルをそれぞれ識別して、その境界付けられたコンテキストを定義すること。これには、非オブジェクト指向のサブシステムにあたる暗黙的なモデルも含まれる。境界づけられたコンテキストそれぞれに名前をつけ、その名前をユビキタス言語の一部にすること。
> モデル同士の接点を記述して、あらゆるコミュニケーションで必要となる明示的な変換について概略を延べ、共有するものがあれば強調すること。
> まず、「現在存在する」領域の地図を書くこと。変換にはその後で取りかかること。
>
> エリック・エバンスのドメイン駆動設計

> ここでの重要なポイントは２つしかない。
>
> 1. 境界づけられたコンテキストには、それについて話ができるように、名前がなければならない。その名前は、チームのユビキタス言語に加えなければならない。
>
> 2. 全員がどこに境界があるかを知っていなければならず、コードのどの一部をとっても、あるいはどんな状況にあっても、そのコンテキストを認識できなければならない。
>
> エリック・エバンスのドメイン駆動設計

### 共有カーネル(Shared Kernel)

### 顧客/供給者の開発チーム(Customer/Supplier Development Team)

### 適応者(Conformist)

### 腐敗防止層(Anticorruption Layer)

### 別々の道(Separate Ways)

### 公開ホストサービス(Open Host Service)

### 公表された言語(Published Language)

## 蒸留

### コアドメイン(Core Domain)

> モデルを煮詰めること。コアドメインを見つけて、それをサポートする大量のモデルやコードから容易に区別する手段を提供すること。最も価値のある特化した概念を浮き彫りにすること。コアは小さくすること。
> 最も才能がある人をコアドメインに割り当て、そうした区分に応じて採用すること。コアに対して力を尽くし、深いモデルを見つけ出し、システムのビジョンを実現するのに十分な、しなやかな設計を開発すること。それ以外の部分への投資は、蒸留したコアをどうサポートするかによって正当化すること。
>
> エリック・エバンスのドメイン駆動設計

### 汎用サブドメイン(Generic Subdomain)

> 設計中のプロジェクトにとって動機となっていない、高凝集のサブドメインを識別すること。そうしたサブドメインから汎用的なモデルを括り出して、別のモジュールに入れること。その中に特化した要素を一切残してはならない。
> 一旦分離したら、その部分に対して継続される開発の優先順位をコアドメインより下げ、その作業にコアとなる開発者を割り当てるのを避けること（そこから得られるドメインについての知識はほとんどないからだ）。このような汎用サブドメインに対しては、既成製品による解決策や公表されているモデルの採用も検討すること。
>
> エリック・エバンスのドメイン駆動設計


> 汎用とは再利用可能という意味ではない
>
> エリック・エバンスのドメイン駆動設計


### ドメインビジョン声明文(Domain Vision Statement)

> コアドメインとそれがもたらす価値に関する簡潔な記述を作成すること（約1ページ）。これが、「価値の提議」（value proposition）である。
>
> エリック・エバンスのドメイン駆動設計

### 強調されたコア(Highlighted Core)

> 蒸留ドキュメントがコアドメインの本質を概説しているなら、それはモデルを変更する意義を示す、実用的な指標としての役割を果たす。モデルやコードの変更が蒸留ドキュメントに影響を与える場合には、他のチームメンバとの協議が必要である。変更したらチームメンバ全員に速やかに通知し、蒸留ドキュメントに含まれていない詳細に対する変更であれば、協議も通知もなしで統合することができ、他のメンバは作業の過程で気づくことになる。そうなれば、開発者はXPが提唱する完全な自律を手に入れることになる。
>
> エリック・エバンスのドメイン駆動設計

### 凝集されたメカニズム(Cohesive Mechanism)

### 隔離されたコア(Segregated Core)

### 抽象化されたコア(Abstracted Core)

> 深いモデルを生み出すブレイクスルーはどこで発生しても価値を生むが、プロジェクト全体の軌道を変えられるのは、それがコアドメインにおいて発生した時だけだ。
>
> エリック・エバンスのドメイン駆動設計

